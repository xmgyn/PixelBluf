<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>PixelBluf</title>
   <link rel="stylesheet" href="/assets/index.css">
   <link rel="stylesheet" href="/assets/video-js.min.css">
   <link rel="stylesheet" href="/assets/video-js.css">
   <link rel="icon" type="image/png" href="/icons/favico.png">
   <script src="/assets/video.min.js"></script>
</head>

<body>
   <div id="container" class="container">
      <div class="sidebar">
         <div class="logo">
            <svg viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" fill="#000000" stroke="#000000">
               <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
               <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
               <g id="SVGRepo_iconCarrier">
                  <g>
                     <path
                        d="m30 57c18.48-13.12 188.13-13.34 200.18 3.38s13.55 129.91-5.8 139.11-179.03 15.09-194.38-1.49-19.61-127 0-141z"
                        fill="#191919"></path>
                     <path
                        d="m113.38 216.51c-77.15 0-86.17-9.74-89.24-13-13.97-15.11-17.58-75.9-13.94-111.13 2.33-22.58 7.3-36.28 15.17-41.87 3.63-2.57 11.84-6.28 41.33-8.81 18.68-1.6 42.08-2.37 65.87-2.17 24.5.21 47.51 1.46 64.79 3.51 29.07 3.45 36.18 8.36 39.31 12.69 7.59 10.52 9.66 40.46 10.23 57.37.93 27.89-1.08 54.5-5.36 71.19-3.18 12.38-7.54 19.51-13.72 22.45-13.35 6.35-68.33 9.27-102 9.69q-6.51.08-12.44.08zm-78.74-153c-.24.21-5.83 4.49-8.53 30.49-1.85 17.9-1.66 40.64.5 60.84 2.65 24.76 7.07 35.36 9.25 37.72 4 3.56 31.64 8.65 91 7.83 51.53-.71 87.59-5.14 94-8.09.33-.26 3.91-3.44 6.85-19.88 3-16.75 4.1-40.75 3-64.18-1.24-25.69-4.71-39.57-6.84-42.94-4.7-3.67-34.05-9.49-94.18-9.81-56.59-.3-90.17 4.62-95 8z"
                        fill="#191919"></path>
                  </g>
                  <g>
                     <path
                        d="m30 57c18.48-13.12 188.13-13.34 200.18 3.38s13.55 129.91-5.8 139.11-179.03 15.09-194.38-1.49-19.61-127 0-141z"
                        fill="#0008ff"></path>
                  </g>
                  <g>
                     <path d="m106.64 88.63c-5.53 3.52-3.88 75.56-.68 79.8s63.75-34 63.8-40.81-57.58-42.51-63.12-38.99z"
                        fill="#ffffff"></path>
                  </g>
               </g>
            </svg>
            <a class="logo-expand">PixelBluf</a>
         </div>
         <div class="side-wrapper">
            <div class="side-title">MENU</div>
            <div class="side-menu">
               <a class="sidebar-link discover is-active" onclick="categoryload(null)">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                     <path
                        d="M9.135 20.773v-3.057c0-.78.637-1.414 1.423-1.414h2.875c.377 0 .74.15 1.006.414.267.265.417.625.417 1v3.057c-.002.325.126.637.356.867.23.23.544.36.87.36h1.962a3.46 3.46 0 002.443-1 3.41 3.41 0 001.013-2.422V9.867c0-.735-.328-1.431-.895-1.902l-6.671-5.29a3.097 3.097 0 00-3.949.072L3.467 7.965A2.474 2.474 0 002.5 9.867v8.702C2.5 20.464 4.047 22 5.956 22h1.916c.68 0 1.231-.544 1.236-1.218l.027-.009z" />
                  </svg>
                  Home
               </a>
               <a class="sidebar-link" href="#">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                     <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M16.158 8.233a4.207 4.207 0 01-4.209 4.234 4.207 4.207 0 01-4.21-4.234A4.206 4.206 0 0111.95 4a4.206 4.206 0 014.21 4.233zM11.95 20c-3.431 0-6.36-.544-6.36-2.72 0-2.177 2.91-2.74 6.36-2.74 3.431 0 6.361.544 6.361 2.72S15.399 20 11.949 20zm6.008-11.69a5.765 5.765 0 01-.984 3.24.158.158 0 00.107.245 3.4 3.4 0 00.483.046c1.643.044 3.118-1.02 3.525-2.621.604-2.379-1.168-4.514-3.425-4.514-.245 0-.48.026-.708.073-.031.007-.064.021-.082.05-.022.034-.006.08.016.11a5.807 5.807 0 011.068 3.37zm2.721 5.203c1.104.217 1.83.66 2.131 1.304a1.923 1.923 0 010 1.67c-.46.998-1.944 1.319-2.52 1.402-.12.018-.215-.086-.203-.206.295-2.767-2.048-4.08-2.654-4.381-.026-.014-.032-.034-.03-.047.003-.009.013-.023.033-.026 1.312-.024 2.722.156 3.243.284zM6.438 11.84c.164-.004.325-.019.483-.046a.158.158 0 00.106-.245 5.765 5.765 0 01-.984-3.24c0-1.25.39-2.416 1.068-3.372.022-.03.037-.075.016-.11-.017-.027-.051-.042-.082-.05a3.52 3.52 0 00-.71-.072c-2.255 0-4.027 2.135-3.423 4.514.407 1.6 1.882 2.664 3.525 2.621zm.159 1.414c.003.013-.003.033-.028.047-.607.302-2.95 1.614-2.656 4.38.013.121-.082.224-.201.207-.577-.083-2.06-.404-2.52-1.402a1.917 1.917 0 010-1.67c.3-.644 1.026-1.087 2.13-1.305.522-.127 1.93-.307 3.244-.283.02.003.03.017.03.026z" />
                  </svg>
                  Artists
               </a>
            </div>
         </div>
         <div class="side-wrapper">
            <div class="side-title">CATEGORY</div>
            <div class="side-menu">
               <a class="sidebar-link" onclick="categoryload('Asian')">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                     <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M15.164 6.083l.948.011c3.405 0 5.888 2.428 5.888 5.78v4.307c0 3.353-2.483 5.78-5.888 5.78A193.5 193.5 0 0112.01 22c-1.374 0-2.758-.01-4.122-.038-3.405 0-5.888-2.428-5.888-5.78v-4.307c0-3.353 2.483-5.78 5.898-5.78 1.286-.02 2.6-.04 3.935-.04v-.163c0-.665-.56-1.204-1.226-1.204h-.972c-1.109 0-2.012-.886-2.012-1.965 0-.395.334-.723.736-.723.412 0 .736.328.736.723 0 .289.246.52.54.52h.972c1.481.01 2.688 1.194 2.698 2.64v.183c.619 0 1.238.008 1.859.017zm-4.312 8.663h-1.03v1.02a.735.735 0 01-.737.723.728.728 0 01-.736-.722v-1.021H7.31a.728.728 0 01-.736-.723c0-.395.334-.722.736-.722h1.04v-1.012c0-.395.324-.723.736-.723.403 0 .736.328.736.723v1.012h1.03c.403 0 .737.327.737.722a.728.728 0 01-.736.723zm4.17-1.629h.099a.728.728 0 00.736-.722.735.735 0 00-.736-.723h-.098a.722.722 0 100 1.445zm1.679 3.315h.098a.728.728 0 00.736-.723.735.735 0 00-.736-.723H16.7a.722.722 0 100 1.445z" />
                  </svg>
                  Category A
               </a>
               <a class="sidebar-link" onclick="categoryload('Gangbang')">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                     <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M7.33 2h9.34c3.4 0 5.32 1.93 5.33 5.33v9.34c0 3.4-1.93 5.33-5.33 5.33H7.33C3.93 22 2 20.07 2 16.67V7.33C2 3.93 3.93 2 7.33 2zm4.72 15.86c.43 0 .79-.32.83-.75V6.92a.815.815 0 00-.38-.79.84.84 0 00-1.28.79v10.19c.05.43.41.75.83.75zm4.6 0c.42 0 .78-.32.83-.75v-3.28a.839.839 0 00-1.28-.79.806.806 0 00-.38.79v3.28c.04.43.4.75.83.75zm-8.43-.75a.827.827 0 01-.83.75c-.43 0-.79-.32-.83-.75V10.2a.84.84 0 01.39-.79c.27-.17.61-.17.88 0s.42.48.39.79v6.91z" />
                  </svg>
                  Category B
               </a>
               <a class="sidebar-link" onclick="categoryload('Indian')">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                     <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M19.761 12.001c0 .814.668 1.475 1.489 1.475.414 0 .75.333.75.743v2.677C22 19.159 20.142 21 17.858 21H6.143C3.859 21 2 19.159 2 16.896v-2.677c0-.41.336-.743.75-.743.822 0 1.49-.662 1.49-1.475 0-.793-.641-1.39-1.49-1.39a.752.752 0 01-.53-.217.74.74 0 01-.22-.525l.002-2.764C2.002 4.842 3.86 3 6.144 3h11.712c2.284 0 4.143 1.842 4.143 4.105L22 9.782a.741.741 0 01-.219.526.753.753 0 01-.531.218c-.821 0-1.489.662-1.489 1.475zm-5.509.647l1.179-1.137a.73.73 0 00-.409-1.25l-1.629-.236-.729-1.462a.737.737 0 00-.662-.41H12a.74.74 0 00-.663.409l-.729 1.463-1.626.235a.735.735 0 00-.6.498.724.724 0 00.187.753l1.179 1.137-.278 1.608a.727.727 0 00.295.719.742.742 0 00.777.054L12 14.27l1.455.757a.733.733 0 00.78-.053.723.723 0 00.296-.718l-.279-1.608z" />
                  </svg>
                  Category C
               </a>
               <a class="sidebar-link" onclick="categoryload('Western')">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                     <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M16.158 8.233a4.207 4.207 0 01-4.209 4.234 4.207 4.207 0 01-4.21-4.234A4.206 4.206 0 0111.95 4a4.206 4.206 0 014.21 4.233zM11.95 20c-3.431 0-6.36-.544-6.36-2.72 0-2.177 2.91-2.74 6.36-2.74 3.431 0 6.361.544 6.361 2.72S15.399 20 11.949 20zm6.008-11.69a5.765 5.765 0 01-.984 3.24.158.158 0 00.107.245 3.4 3.4 0 00.483.046c1.643.044 3.118-1.02 3.525-2.621.604-2.379-1.168-4.514-3.425-4.514-.245 0-.48.026-.708.073-.031.007-.064.021-.082.05-.022.034-.006.08.016.11a5.807 5.807 0 011.068 3.37zm2.721 5.203c1.104.217 1.83.66 2.131 1.304a1.923 1.923 0 010 1.67c-.46.998-1.944 1.319-2.52 1.402-.12.018-.215-.086-.203-.206.295-2.767-2.048-4.08-2.654-4.381-.026-.014-.032-.034-.03-.047.003-.009.013-.023.033-.026 1.312-.024 2.722.156 3.243.284zM6.438 11.84c.164-.004.325-.019.483-.046a.158.158 0 00.106-.245 5.765 5.765 0 01-.984-3.24c0-1.25.39-2.416 1.068-3.372.022-.03.037-.075.016-.11-.017-.027-.051-.042-.082-.05a3.52 3.52 0 00-.71-.072c-2.255 0-4.027 2.135-3.423 4.514.407 1.6 1.882 2.664 3.525 2.621zm.159 1.414c.003.013-.003.033-.028.047-.607.302-2.95 1.614-2.656 4.38.013.121-.082.224-.201.207-.577-.083-2.06-.404-2.52-1.402a1.917 1.917 0 010-1.67c.3-.644 1.026-1.087 2.13-1.305.522-.127 1.93-.307 3.244-.283.02.003.03.017.03.026z" />
                  </svg>
                  Category D
               </a>
            </div>
         </div>
      </div>
      <div class="wrapper">
         <div class="header">
            <div class="search-bar">
               <input type="text" placeholder="Search">
            </div>
            <div class="sort" onclick="orderChange()">
               Sort
               <svg id="SVG_element" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                  <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                  <g id="SVGRepo_iconCarrier">
                     <path d="M4 16L13 16" stroke="#FFFFFF" stroke-width="1.5" stroke-linecap="round"></path>
                     <path d="M6 11H13" stroke="#FFFFFF" stroke-width="1.5" stroke-linecap="round"></path>
                     <path d="M8 6L13 6" stroke="#FFFFFF" stroke-width="1.5" stroke-linecap="round"></path>
                     <path d="M17 4L17 20L20 16" stroke="#FFFFFF" stroke-width="1.5" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                  </g>
               </svg>
            </div>
         </div>
         <div id="main-container" class="main-container">
            <div class="small-header">All Videos</div>
         </div>
      </div>
   </div>
   <div id="stream-area" class="stream-area">
      <div id="back" onclick="closevideo()"><svg fill="#0008ff" version="1.1" id="Layer_1"
            xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10vw" height="15vh"
            viewBox="-51.12 -51.12 174.24 174.24" enable-background="new 0 0 72 72" xml:space="preserve"
            stroke="#0008ff" stroke-width="0.00072" style="padding-top: 25px">
            <g id="SVGRepo_bgCarrier" stroke-width="0"
               transform="translate(8.280000000000001,8.280000000000001), scale(0.77)">
               <rect x="-51.12" y="-51.12" width="174.24" height="174.24" rx="87.12" fill="#1f1f1f" strokewidth="0">
               </rect>
            </g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#0008ff"
               stroke-width="5.328">
               <g>
                  <path
                     d="M48.252,69.253c-2.271,0-4.405-0.884-6.011-2.489L17.736,42.258c-1.646-1.645-2.546-3.921-2.479-6.255 c-0.068-2.337,0.833-4.614,2.479-6.261L42.242,5.236c1.605-1.605,3.739-2.489,6.01-2.489c2.271,0,4.405,0.884,6.01,2.489 c3.314,3.314,3.314,8.707,0,12.021L35.519,36l18.743,18.742c3.314,3.314,3.314,8.707,0,12.021 C52.656,68.369,50.522,69.253,48.252,69.253z M48.252,6.747c-1.202,0-2.332,0.468-3.182,1.317L21.038,32.57 c-0.891,0.893-0.833,2.084-0.833,3.355c0,0.051,0,0.101,0,0.151c0,1.271-0.058,2.461,0.833,3.353l24.269,24.506 c0.85,0.85,1.862,1.317,3.063,1.317c1.203,0,2.273-0.468,3.123-1.317c1.755-1.755,1.725-4.61-0.03-6.365L31.292,37.414 c-0.781-0.781-0.788-2.047-0.007-2.828L51.438,14.43c1.754-1.755,1.753-4.61-0.001-6.365C50.587,7.215,49.454,6.747,48.252,6.747z">
                  </path>
               </g>
            </g>
            <g id="SVGRepo_iconCarrier">
               <g>
                  <path
                     d="M48.252,69.253c-2.271,0-4.405-0.884-6.011-2.489L17.736,42.258c-1.646-1.645-2.546-3.921-2.479-6.255 c-0.068-2.337,0.833-4.614,2.479-6.261L42.242,5.236c1.605-1.605,3.739-2.489,6.01-2.489c2.271,0,4.405,0.884,6.01,2.489 c3.314,3.314,3.314,8.707,0,12.021L35.519,36l18.743,18.742c3.314,3.314,3.314,8.707,0,12.021 C52.656,68.369,50.522,69.253,48.252,69.253z M48.252,6.747c-1.202,0-2.332,0.468-3.182,1.317L21.038,32.57 c-0.891,0.893-0.833,2.084-0.833,3.355c0,0.051,0,0.101,0,0.151c0,1.271-0.058,2.461,0.833,3.353l24.269,24.506 c0.85,0.85,1.862,1.317,3.063,1.317c1.203,0,2.273-0.468,3.123-1.317c1.755-1.755,1.725-4.61-0.03-6.365L31.292,37.414 c-0.781-0.781-0.788-2.047-0.007-2.828L51.438,14.43c1.754-1.755,1.753-4.61-0.001-6.365C50.587,7.215,49.454,6.747,48.252,6.747z">
                  </path>
               </g>
            </g>
         </svg></div>
      <div class="video-stream" style="width: 100%">
         <video id="my_video_1" class="stream video-js vjs-theme-forest" controls preload="none" poster='' width="100%"
            height="auto" style="cursor: default">
            <source id="my_video_source" type='video/mp4' />
         </video>
      </div>
   </div>
   <script>
      var DATA = {};
      var videos = [];
      var order = 'asc';
      var stream = false;
      var currentID = null;
      var ARTISTS = ['Artist One', 'Artist Two', 'Artist Three', 'Artist Four'];

      async function fetchData() {
         try { const response = await fetch("http://localhost:3000/all"); if (response.ok) { const data = await response.json(); DATA = data; } else { return null; } } catch (error) { console.error('Error:', error); return null; }

         videos = Object.entries(DATA).map(([key, item]) => {
            const videoDiv = document.createElement('div');
            id = key.slice(0, -4)

            if (item === null) item = { Time: 0, Artist: [], Title: "" };

            videoDiv.id = id;
            videoDiv.classList.add('video');
            videoDiv.style.backgroundImage = `url('./thumbnails/${id}.jpg')`;
            videoDiv.setAttribute("onclick", "openvideo(id)");

            const videoTime = document.createElement('div');
            videoTime.classList.add('video-time');
            videoTime.textContent = `${item.Time} min`;
            videoDiv.appendChild(videoTime);

            const videoBy = document.createElement('div');
            videoBy.classList.add('video-by');
            videoBy.textContent = item.Artist.join(', ');
            videoDiv.appendChild(videoBy);

            const videoTitle = document.createElement('div');
            videoTitle.classList.add('video-title');
            videoTitle.textContent = item.Title;
            videoDiv.appendChild(videoTitle);

            return videoDiv;
         });

         return "OK";
      }

      function render(startn, endn, category = null) {
         const mainContainer = document.getElementById('main-container');
         for (let i = startn; i <= endn && i < videos.length;) {
            const videosGroup = document.createElement('div'); videosGroup.classList.add('videos'); let count = 0; while (i < videos.length && i <= endn && count < 3) { /* if (category(videos[i])) { } */
               videosGroup.appendChild(videos[i]);
               count++; i++;
            } mainContainer.appendChild(videosGroup);
         }
      }

      function categoryload(category) {
         alert(category);
         render(startn, endn, category = null)
      }

      function orderChange() {
         const svgElement = document.getElementById('SVG_element');
         if (svgElement.hasAttribute('transform')) { svgElement.removeAttribute('transform'); }
         else { svgElement.setAttribute('transform', 'rotate(180)'); }
         if (order === 'asc') order = 'desc';
         else order = 'asc';
         videos.reverse();
         const videosDiv = document.querySelectorAll('.videos');
         videosDiv.forEach(videosDiv => { videosDiv.parentNode.removeChild(videosDiv); });
         render(0, 20);
      }

      document.addEventListener("DOMContentLoaded", async () => {
         var response = await fetchData();
         if (!response) return;
         render(0, 20);
      })

      function showDropdown(searchText) {
         const dropdown = document.getElementById('artistDropdown');
         dropdown.innerHTML = '';
         if (searchText.length > 0) {
            const filteredValues = ARTISTS.filter(value => value.toLowerCase().includes(searchText.toLowerCase()));
            filteredValues.forEach(value => {
               const div = document.createElement('div');
               div.textContent = value;
               div.style.padding = '0.5rem';
               div.style.cursor = 'pointer';
               div.onclick = () => {
                  const artistInput = document.getElementById('artist');
                  artistInput.value = artistInput.value + ', ' + value + ', ';
                  dropdown.style.display = 'none';
               };
               dropdown.appendChild(div);
            });
            dropdown.style.display = 'block';
         } else {
            dropdown.style.display = 'none';
         }
      }

      document.addEventListener('click', function (event) {
         const dropdown = document.getElementById('artistDropdown');
         if (!dropdown.contains(event.target) && event.target.id !== 'artist') {
            dropdown.style.display = 'none';
         }
      });

      document.addEventListener("keydown", function () {
         if (event.key === 'o' && stream) {
            const form = `<div id="form" class="form">
                   <form id="registrationForm"> <div class="form-heading">Content ${currentID}</div> <div class="form-group">  </form>
            </div>`
            document.getElementById("stream-area").innerHTML += form;
            var artistContainer = document.getElementById('artist-container');
            var artist = document.querySelector('.artist');
            artist.addEventListener('keydown', function (event) {
               if (event.key === ',') {
                  event.preventDefault();
                  var value = artist.value.trim();
                  if (value) {
                     var tag = document.createElement('div');
                     tag.classList.add('tag');
                     tag.textContent = value;
                     var removeTag = document.createElement('span');
                     removeTag.classList.add('remove-tag');
                     removeTag.textContent = '✖';
                     removeTag.addEventListener('click', function () {
                        artistContainer.removeChild(tag);
                     });
                     tag.appendChild(removeTag);
                     artistContainer.appendChild(tag);
                     artist.value = '';
                  }
               }
               document.getElementById('form').addEventListener('submit', function (event) {
                  event.preventDefault(); 
                  var title = document.getElementById('title').value; 
                  var time = document.getElementById('time').value;
                  var artists = []; 
                  document.querySelectorAll('.tag').forEach(function (tag) { artists.push(tag.textContent.replace('✖', '').trim()); });
                  var categories = []; document.querySelectorAll('input[name="category"]:checked').forEach(function (checkbox) { categories.push(checkbox.value); }); var data = { title: title, time: time, artist: artists, category: categories };
                  
                  fetch(`/info?id=${currentID}`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) }).then(response => response.json()).then(result => { console.log('Success:', result); }).catch(error => { console.error('Error:', error); });
               });
            });
         }
      })


      function openvideo(id) {
         document.getElementById("stream-area").style.setProperty("display", "grid");
         document.getElementById("container").style.setProperty("display", "none");
         const videoElement = document.getElementById('my_video_1_html5_api');
         if (videoElement) videoElement.setAttribute("src", `http://localhost:3000/video?id=${id}`);
         else document.getElementById('my_video_source').setAttribute("src", `http://localhost:3000/video?id=${id}`);
         videojs(document.querySelector('.video-js'));
         stream = !stream;
         currentID = id;
      }
      function closevideo() {
         document.getElementById("stream-area").style.setProperty("display", "none");
         document.getElementById("container").style.setProperty("display", "flex");
         document.getElementById('my_video_source').removeAttribute("src");
         stream = !stream;
         currentID = null;
         var streamArea = document.getElementById("stream-area");
         var form = document.getElementById('form');
         if (form) { streamArea.removeChild(form); }
         const videoElement = document.getElementById('my_video_1_html5_api');
         const videoSource = document.getElementById('my_video_source');
         if (videoSource) { videoSource.removeAttribute("src"); }
         if (videoElement) { videoElement.pause(); videoElement.load(); }
      }
   </script>
</body>

</html>